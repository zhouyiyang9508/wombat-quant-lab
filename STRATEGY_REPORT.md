# Wombat Quant Lab — 策略优化报告

> 作者：代码熊 🐻 | 日期：2026-02-19

## 执行摘要

经过 v5（规则策略）vs v3 ML（机器学习增强）的公平 Lump Sum 对比（$10,000 初始资金，相同数据源），**v5 规则策略全面胜出**：

- **TQQQ v5 Beast** ⭐：CAGR 41.8%, MaxDD -62.6%, Calmar 0.67
- **BTC v5 Beast** ⭐：CAGR 61.0%, MaxDD -74.0%, Calmar 0.82

ML v3 策略虽然降低了回撤，但严重损失了收益，不如 Buy & Hold。

## 公平对比结果

### TQQQ（2010-02-11 → 2026-02-18，4028 天）

| 策略 | 最终价值 | CAGR | MaxDD | Sharpe | Calmar |
|------|----------|------|-------|--------|--------|
| **v5 Beast** ⭐ | **$2,687,728** | **41.8%** | -62.6% | **0.85** | **0.67** |
| v3 ML (GBM) | $89,877 | 14.7% | -51.4% | 0.46 | 0.29 |
| Buy & Hold | $2,389,580 | 40.8% | -81.7% | 0.80 | 0.50 |

### BTC（2017-01-01 → 2026-02-18）

| 策略 | 最终价值 | CAGR | MaxDD | Sharpe | Calmar |
|------|----------|------|-------|--------|--------|
| **v5 Beast** ⭐ | **$774,007** | **61.0%** | -74.0% | **0.83** | **0.82** |
| v3 ML (多因子) | $108,008 | 29.8% | -61.7% | 0.60 | 0.48 |
| Buy & Hold | $666,842 | 58.4% | -83.2% | 0.77 | 0.70 |

## 为什么 ML 输了？

### 1. 过度择时（Overtrading）
ML v3 的 GBM 分类器在 200MA 以下时**强制清仓 0%**，而 v5 保留 30-35% 底仓。TQQQ 和 BTC 的很多大反弹恰好发生在 200MA 以下（V 型反弹），ML 完全错过了。

### 2. Walk-forward 分类器精度不够
在样本外（未来数据）的预测准确率只有 ~55%，接近随机，导致频繁误判 regime，来回切换吃手续费和滑点。

### 3. 简单规则的优势
v5 的宽幅滞后带（TQQQ: 90%/105%, BTC: 92%/103%）极大减少了 regime 切换次数，避免 whipsaw。配合 RSI 抄底机制，在熊市中也能捕捉到大部分反弹收益。

## 最优策略详解

### TQQQ v5 Beast — 宽幅滞后带策略

**牛市（price > SMA200 × 1.05 确认）：**
- 100% TQQQ，全仓吃涨
- RSI(10) > 80 且周涨幅 > 15% 时才减到 80%（极端狂热）

**熊市（price < SMA200 × 0.90 确认）：**
- 底仓 30%（关键！捕捉 V 型反弹）
- RSI(10) < 30 → 60%（适度抄底）
- RSI(10) < 20 或周跌 > 12% → 80%（恐慌买入）
- RSI(10) > 65 → 回到 30% 底仓

**核心创新：宽幅滞后带**
- 进入熊市：价格跌到 SMA200 的 **90%** 才触发（很晚的确认）
- 退出熊市：价格涨到 SMA200 的 **105%** 才恢复牛市
- 效果：极少切换，避免 whipsaw

### BTC v5 Beast — 减半周期 + Mayer Multiple

**牛市（price > SMA200 × 1.03）：**
- 100% BTC
- Mayer Multiple > 3.0 → 减至 70%（泡沫保护）
- Mayer Multiple > 3.5 → 减至 50%（极端泡沫）
- 减半后 30+ 个月 → 上限 90%（晚期谨慎）

**熊市（price < SMA200 × 0.92）：**
- 底仓 35%（减半后 0-12 月提升至 ~52%）
- RSI(14) < 30 → 60%
- RSI(14) < 20 → 80%
- 周跌 > 20% → 70%

**为何 BTC 用窄带（92%/103%）而 TQQQ 用宽带（90%/105%）：**
BTC 熊市特征明确且持续时间长，窄带可以更快识别趋势。TQQQ 波动更大，需要宽带防止假信号。

## ML 实验的价值

虽然 ML v3 没有胜出，但实验有以下收获：
1. **Pi Cycle Top 指标**有效识别 BTC 大顶，可考虑作为 v5 的辅助卖出信号
2. **Puell Multiple 代理**在底部识别上与 RSI 高度重合，独立价值有限
3. **Walk-forward GBM** 在日频数据上精度不够，或许在周频/月频上更适合
4. 验证了**简单规则 > 复杂 ML** 在高波动资产上的结论

## 防止未来函数审计 ✓

所有策略均通过审计：
- SMA200, RSI: `rolling().mean()` → 仅用历史数据 ✓
- Weekly return: `pct_change(5/7)` → 仅用历史数据 ✓
- ML Walk-forward: 训练集 [0 : T-20]，预测 T → 无标签泄露 ✓
- Mayer Multiple: price / SMA200 → 仅用当前和历史 ✓
- 减半日期: 已知历史事件 ✓

## 数据源

- TQQQ: Stooq.com 日线 (`tqqq/data/tqqq_daily.csv`, 4028 行)
- BTC: Stooq.com 日线 (`btc/data/btc_daily.csv`, 4173 行)

## 结论与建议

1. **v5 规则策略是当前最优**，无需替换
2. 可考虑将 Pi Cycle Top 作为 BTC v5 的辅助卖出信号（v6 方向）
3. ML 在更长时间框架（周频/月频）或更多特征（链上数据）上可能有价值
4. 回撤在 62-74% 范围内，符合用户 70-80% 容忍度

---
*Generated by 代码熊 🐻 — 2026-02-19*
